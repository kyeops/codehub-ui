<template>
  <require from="../resources/value-converters/sort"></require>
  <require from="../resources/value-converters/chunk"></require>

  <div class="container-fluid title-wrapper home-wrapper">
    <ul class="nav nav-tabs home-tabs" role="tablist">
      <li role="presentation"><a class="featured active" href="#featured" aria-controls="featured" role="tab" data-toggle="tab"><i class="material-icons" aria-hidden="true">highlight</i> Featured Projects</a></li>
      <li role="presentation"><a href="#popular" aria-controls="popular" role="tab" data-toggle="tab"><i class="material-icons" aria-hidden="true">star</i> Most Popular Projects</a></li>
      <li role="presentation"><a href="#trending" aria-controls="trending" role="tab" data-toggle="tab"><i class="material-icons" aria-hidden="true">favorite</i> Healthiest Projects</a></li>
    </ul>
  </div>

  <div class="container-fluid loading-wrapper">
    <div class="row">
      <div class="col-lg-12 cards-wrapper">
          <div class="home-tab tab-content">
            <div role="tabpanel" class="tab-pane active" id="featured">
              <span tabindex="0"  aria-label="Featured projects panel, top ${featured.length} projects."></span>
              <div if.bind="(projects.length < 1) && (searchingFeatured)" class="loader" width="100%" height="100%" align="center" valign="center">
                <img src="../../img/loading.svg" width="100px" alt="Loading...">
              </div>
              <template repeat.for="repo of featured | chunk: 3">
                <div class="row">
                  <!-- <div if.bind="$index != 1">
                      <compose view-model="../components/card-feature" if.bind="repo[0]" model.bind="repo[0]"></compose>
                      <compose view-model="../components/card-feature" if.bind="repo[1]" model.bind="repo[1]"></compose>
                      <compose view-model="../components/card-feature" if.bind="repo[2]" model.bind="repo[2]"></compose>
                  </div> -->

                  <!-- <div if.bind="$index == 1"> -->
                      <compose view-model="../components/card-feature" if.bind="!repo[0].isFake" model.bind="repo[0]"></compose>
                      <compose view-model="../components/card-feature-fake" if.bind="repo[0].isFake" model.bind="repo[0]"></compose>
    
                      <compose view-model="../components/card-feature" if.bind="!repo[1].isFake" model.bind="repo[1]"></compose>
                      <compose view-model="../components/card-feature-fake" if.bind="repo[1].isFake" model.bind="repo[1]"></compose>
                      
                      <compose view-model="../components/card-feature" if.bind="!repo[2].isFake" model.bind="repo[2]"></compose>
                      <compose view-model="../components/card-feature-fake" if.bind="repo[2].isFake" model.bind="repo[2]"></compose>
                  <!-- </div> -->
                </div>
              </template>
            </div>
            <div role="tabpanel" class="tab-pane" id="popular">
              <span tabindex="0"  aria-label="Popular projects panel, top ${projects.length} projects."></span>
              <div if.bind="(projects.length < 1) && (searchingPopular)" class="loader" width="100%" height="100%" align="center" valign="center">
                <img src="../../img/loading.svg" width="100px" alt="Loading...">
              </div>
              <template repeat.for="repo of projects | sort: { propertyName: selectedSort, direction: sortDirection} | chunk: 3">
                <div class="row">
                  <compose view-model="../components/card" if.bind="repo[0]" model.bind="repo[0]"></compose>
                  <compose view-model="../components/card" if.bind="repo[1]" model.bind="repo[1]"></compose>
                  <compose view-model="../components/card" if.bind="repo[2]" model.bind="repo[2]"></compose>
                </div>
              </template>
            </div>
            <div role="tabpanel" class="tab-pane" id="trending">
              <span tabindex="0"  aria-label="Healthiest projects panel, top ${healthiest.length} projects."></span>
              <div if.bind="(healthiest.length < 1) && (searchingHealthiest)" class="loader" width="100%" height="100%" align="center" valign="center">
                <img src="../../img/loading.svg" width="100px" alt="Loading...">
              </div>
              <template repeat.for="repo of healthiest | chunk: 3">
                <div class="row">
                  <compose view-model="../components/card-health" if.bind="repo[0]" model.bind="repo[0]"></compose>
                  <compose view-model="../components/card-health" if.bind="repo[1]" model.bind="repo[1]"></compose>
                  <compose view-model="../components/card-health" if.bind="repo[2]" model.bind="repo[2]"></compose>
                </div>
              </template>
            </div>
          </div>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12 col-btn">
        <button if.bind="projects.length > 0" class="btn btn-default" click.delegate="router.navigateToRoute('explore')">Explore All Projects<i class="material-icons" aria-hidden="true">keyboard_arrow_right</i></button>
      </div>
    </div>
  </div>
</template>
